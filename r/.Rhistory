HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
break
}
}
obsCase
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 211,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
break
}
}
obsCase
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 211,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
break
}
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
}
obsCase
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
break
}
}
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
break
}
}
obsCase
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 109,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
#break
}
}
obsCase
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 109,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
break
}
}
obsCase
obsState
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 109,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
break
}
if (obsState == modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]){
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
}
}
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 109,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 211,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (as.double(obsCase[[i]]) <= this_limit){
obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
break
}
if (obsState == modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]){
obsCase[[i]] <- modelVars[[j]]$varStates[obsState]
}
}
init_val <- obsCase[[i]]
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
#obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (init_val <= this_limit){
#obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[k]
break
}
}
init_val <- obsCase[[i]]
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
#obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (isTRUE(init_val <= this_limit)==TRUE){
#obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[k]
break
}
}
if (obsCase[[i]] == init_val){
obsCase[[i]] <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
}
init_val <- obsCase[[i]]
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
#obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (isTRUE(init_val <= this_limit)==TRUE){
#obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[k]
break
}
}
if (isTRUE(obsCase[[i]] == init_val)==TRUE){
obsCase[[i]] <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
}
obsCase
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 211,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
init_val <- obsCase[[i]]
for (k in seq_along(modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)])){
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
#obsState <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
if (isTRUE(init_val <= this_limit)==TRUE){
#obsState <- k
obsCase[[i]] <- modelVars[[j]]$varStates[k]
break
}
}
obsCase
init_val
k
k=1
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
this_limit
isTRUE(init_val <= this_limit)==TRUE
k=2
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
this_limit
isTRUE(init_val <= this_limit)==TRUE
k=17
this_limit <- as.double(sub('.* - ', '', modelVars[[j]]$varStates[k]))
this_limit
isTRUE(init_val <= this_limit)==TRUE
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 109,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
init_val <- obsCase[[i]]
match_state <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
for (st in modelVars[[j]]$varStates){
this_limit <- as.double(sub('.* - ', '', st))
if (init_val <= this_limit){
match_state <- st
break
}
}
obsCase[[i]] <- match_state
obsCase
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 109,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
init_val <- obsCase[[i]]
init_val
match_state <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
match_state
modelVars[[j]]$varStates
for (st in modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)]){
this_limit <- as.double(sub('.* - ', '', st))
if (init_val <= this_limit){
match_state <- st
break
}
}
match_state
init_val
this_limit
init_val <= this_limit
init_val
init_val <- as.double(obsCase[[i]])
match_state <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
for (st in modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)]){
this_limit <- as.double(sub('.* - ', '', st))
if (init_val <= this_limit){
match_state <- st
break
}
}
match_state
obsCase[[i]] <- match_state
obsCase
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 212,##
HR_Disc = 90,##
GCS_Disc = 15
)
obsCase<-test_case
init_val <- as.double(obsCase[[i]])
match_state <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
for (st in modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)]){
this_limit <- as.double(sub('.* - ', '', st))
if (init_val <= this_limit){
match_state <- st
break
}
}
obsCase[[i]] <- match_state
obsCase
setDiscretisedState <- function(inputExpBN, obsCase){
modelVars <- inputExpBN$bayesnetwork$modelVariables
for (i in seq_along(obsCase)){
for (j in seq_along(modelVars)){
if (names(obsCase)[i] == modelVars[[j]]$varID){
if (modelVars[[j]]$varType == "ContinuousInterval"){
init_val <- as.double(obsCase[[i]])
match_state <- modelVars[[j]]$varStates[length(modelVars[[j]]$varStates)]
for (st in modelVars[[j]]$varStates[-length(modelVars[[j]]$varStates)]){
this_limit <- as.double(sub('.* - ', '', st))
if (init_val <= this_limit){
match_state <- st
break
}
}
obsCase[[i]] <- match_state
}
}
}
}
return(obsCase)
}
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 212,##
HR_Disc = 90,##
GCS_Disc = 15
)
TICNoUncert <- createDiscExpBN(modelFile = "TICMIL/TICMIL_Disc_No_Uncert.cmpx",
framFile = "TICMIL/TICMIL_Disc_No_Uncert_framework.json")
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 212,##
HR_Disc = 90,##
GCS_Disc = 15
)
test_case
new_case <- setDiscretisedState(TICNoUncert, test_case)
new_case
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 119,##
HR_Disc = 90,##
GCS_Disc = 15
)
new_case <- setDiscretisedState(TICNoUncert, test_case)
new_case
test_case_2 <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative")
test_case_2
new_case_2 <- setDiscretisedState(TICNoUncert, test_case_2)
new_case_2
source("BNExplain.R")
TICNoUncert <- createDiscExpBN(modelFile = "TICMIL/TICMIL_Disc_No_Uncert.cmpx",
framFile = "TICMIL/TICMIL_Disc_No_Uncert_framework.json")
test_case <- c(Energy = "Low",##
MOI = "Blunt",##
Soft_Tissue_Injury_LL = "Mild",##
LB_Fracture_LL = "Yes",##
Damaged_LL_Artery = "No",#
Pelvic_Fracture = "No",##
Chest_Bleeding_Assessment = "Negative",##
Abdo_Bleeding_Assessment = "Negative",##
SBP_Disc = 119,##
HR_Disc = 90,##
GCS_Disc = 15
)
generateAbstractExplanation(TICNoUncert, test_case, 'cont_test.json')
source('BNExplain.R')
TICNoUncert <- createDiscExpBN(modelFile = "TICMIL/TICMIL_Disc_No_Uncert.cmpx",
framFile = "TICMIL/TICMIL_Disc_No_Uncert_framework.json")
TICNoUncert <- createDiscExpBN(modelFile = "../examples/tic/TICMIL_Disc_No_Uncert.cmpx",
framFile = "../examples/tic/TICMIL_Disc_No_Uncert_explanandum_R.json")
case_two <- c(Energy = "High",##
case_two <- c(Energy = "High",##
MOI = "Explosion",##
Damaged_Neck_Artery = "Yes",
LB_Fracture_UL = "Yes",##
Damaged_UL_Artery = "Yes",#
Chest_Bleeding_Assessment = "Positive",##
Abdo_Bleeding_Assessment = "Positive",##
SBP_Disc = "68.66285714285713 - 74.52914285714284",##
HR_Disc = "119.22424242424242 - 125.46575757575756",
Temperature = "<34")
)
case_two <- c(Energy = "High",##
MOI = "Explosion",##
Damaged_Neck_Artery = "Yes",
LB_Fracture_UL = "Yes",##
Damaged_UL_Artery = "Yes",#
Chest_Bleeding_Assessment = "Positive",##
Abdo_Bleeding_Assessment = "Positive",##
SBP_Disc = "68.66285714285713 - 74.52914285714284",##
HR_Disc = "119.22424242424242 - 125.46575757575756",
Temperature = "<34")
TICNoUncert$bayesnetwork$modelVariables$Temperature$varStates
source('BNExplain.R')
survbn <- from_cmpx('../examples/surv/Survival_Discrete_v2.cmpx')
survbn <- from_static_disc_cmpx('../examples/surv/Survival_Discrete_v2.cmpx')
survbn
for (vr in survbn$getVariables()){
print(vr)
}
for (vr in surv$modelVariables){
cat(vr$varID, 'has the states:\t')
for (st in vr$varStates){
cat(paste0(st, ', '))
}
cat('\n')
}
for (vr in survbn$modelVariables){
cat(vr$varID, 'has the states:\t')
for (st in vr$varStates){
cat(paste0(st, ', '))
}
cat('\n')
}
for (vr in survbn$modelVariables){
cat(vr$varID, 'has the states:\t')
for (st in vr$varStates){
cat(paste0('"'st, '", '))
for (vr in survbn$modelVariables){
cat(vr$varID, 'has the states:\t')
for (st in vr$varStates){
cat(paste0('\"'st, '\", '))
for (vr in survbn$modelVariables){
cat(vr$varID, 'has the states:\t')
for (st in vr$varStates){
cat(paste0('\"',st, '\", '))
}
cat('\n')
}
citation("gRain")
